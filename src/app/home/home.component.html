<div appWindowsEvent
     (wheel)="onWheeling($event)"
     (resize)="recheck($event)"
     (panstart)="isShowCarousel = true"
     class="wrapping">


    <div *ngIf="!isShowCategory"
         class="logo zindex-fixed"></div>


    <app-category (toggling)="togglingCategory($event)"
                  [currentTitle]="item.category"
                  [style.width]="isXS ? '100vw' : '100vh'"
                  [style.height]="isXS ? '100vh' : '100vw'"
                  [class.zindex-modal]="isShowCategory"
                  [class.category-horizon]="!isXS"
                  class="wrapping-category zindex-fixed"
    ></app-category>

    <ng-container *ngIf="!isShowCategory">
        <div [class.absolute-center]="!isXS"
             [class.position-relative]="isXS"
             class="wrapping-title text-center mt-sm-0 po zindex-fixed">
            <h2 class="font-display color-white shadow-small">{{ item.title }}</h2>

            <ng-container *ngIf="isXS; else HorizonSubtitle">
                <h3 class="font-body color-white shadow-small font-weight-normal">{{ item.subtitle }}</h3>
            </ng-container>

            <ng-template #HorizonSubtitle>
                <div (tap)="onTapPlay(item)"
                     class="icon mx-auto mt-2 mb-1">
                    <img src="assets/images/icons/icon_play_45px.png" height="45" width="45"/>
                </div>
                <small class="font-body color-white font-weight-light">{{ item.duration }}</small>
            </ng-template>
        </div>

        <ng-container *ngIf="isBgVideoChanged && checkShowCarousel() && !isShowPlayer && !isPanning">
            <div *ngIf="isXS" class="background-gradient absolute-center"></div>
            <app-video-player (changeState)="onBgStateChange($event)"
                              [videoId]="videoId"
                              [width]="windowWidth"
                              [height]="windowHeight"
                              [start]="start"
                              [end]="end"
                              [isBG]="true"
                              class="zindex-background absolute-center"
            ></app-video-player>
        </ng-container>

        <div [class.progress-horizon]="!isXS"
             class="wrapping-progress avoid-clicks zindex-fixed row">
            <app-progress-bar [currentIndex]="currentIndex"
                              [totalItems]="items.length"
                              class="progress-bar col-2 offset-2 offset-sm-5"
            ></app-progress-bar>
        </div>

        <ng-container *ngIf="!isXS && !isShowCarousel">
            <div class="wrapping-preview row col-8 zindex-fixed">
                <app-preview [item]="item"></app-preview>
            </div>
        </ng-container>
    </ng-container>


    <app-carousel *ngIf="isShowCarousel && !isShowCategory"
                  (update)="setItem($event)"
                  (tapPlay)="onTapPlay($event)"
                  (tapCarousel)="togglingCarousel($event)"
                  (startPanning)="isPanning = true"
                  (stopPanning)="isPanning = false"
                  [items]="items"
                  [currentIndex]="currentIndex"
                  [isXS]="isXS"
                  [class.absolute-center]="!isXS"
                  [class.carousel-horizon]="isXS"
                  class="d-block zindex-popover"
    ></app-carousel>



    <div [style.background-image]="bgCoverImage"
         [class.bg-cover-zindex]="isBgVideoPlaying"
         class="bg-cover background-cover zindex-background"
    ></div>

    <app-fullscreen-player *ngIf="isShowPlayer"
                           (changeState)="onStateChange($event)"
                           (tapClose)="onTapClose()"
                           [videoId]="playItem.videoId"
                           [isXS]="isXS"
                           class="zindex-popover"
    ></app-fullscreen-player>


</div>
